# 製造業の歩留まりカイゼン：Allyeで実現する、勘と経験を越えたデータドリブンな工程改善

半導体製造の現場は、常にミクロン単位の精度と、0.1%の歩留まり向上を追い求める、終わりなき戦いの場です。

プロセスエンジニアの佐藤さんは、今日も頭を抱えていました。主力製品の歩留まりが、目標の95%にどうしても届かない。先週からじわじわと低下傾向にあり、原因は依然として不明。彼の前には、何十もの工程から吐き出される膨大なセンサーデータと、複雑に絡み合った管理図（SPCチャート）が広がっています。データは山ほどある。しかし、どこに改善のメスを入れればいいのか、確信が持てないのです。

<p align="center">
  <img src="./imgs/semicon_engineer_problem.png"
       alt="semicon_engineer_problem" width="500">
</p>

「リソグラフィ工程の露光時間を少し変えてみるか？」「いや、CVD工程のガス流量が怪しいとベテランの田中さんは言っていた…」

一つ一つの仮説を検証するには、生産ラインを一部変更し、結果が出るまで数日待たなければなりません。その間も、不良品は生産され続けます。これは、時間とコストを浪費する、まさに「暗闇の中を手探りで進む」ようなものです。

---

## 従来のアプローチ：終わらない「モグラ叩き」と相関の罠

問題が発生したとき、一般的な対応はこうです。

まず、佐藤さんのような担当エンジニアと、品質保証、各工程のベテランが集まり、対策会議が開かれます。そこで交わされるのは、長年の経験と勘に基づいたディスカッション。

*   「最近、エッチング装置の調子が悪い気がする」
*   「この前の原材料ロットから、微妙に不純物が増えたんじゃないか？」
*   「A棟のクリーンルームの温度が、先週少し高かったのが影響しているかも」

これらの仮説は貴重ですが、どれも確証はありません。結局、「一番怪しい」と思われる箇所から一つずつ試していくしかなく、時間のかかる「モグラ叩き」に陥りがちです。

<p align="center">
  <img src="./imgs/semicon_mole_game.png"
       alt="semicon_mole_game" width="600">
</p>

また、データ分析チームが駆り出されても、従来の相関分析には限界があります。「露光時間と不良率に相関あり」という結果が出ても、それが本当に「原因」なのか、あるいは第三の要因（例：その日の室温）が両方に影響しているだけの「見せかけの相関」なのか、区別がつきません。

相関はヒントにはなりますが、確信を持ってリソースを投入するための根拠としては、あまりに弱いのです。

---

## The Allye Way：因果の光でボトルネックを照らす

この堂々巡りを終わらせるのが、**因果推論（Causal Inference）** の考え方です。そして、Allyeは、このパワフルな分析手法を、コーディング不要の直感的なワークフローに変えます。

複数の工程が複雑に絡み合う製造プロセスの中から、「どの工程の、どのパラメータを改善すれば、最も歩留まりが向上するのか？」という問いに、明確な答えを与えます。

今回のシナリオでは、複数の改善施策候補の中から「真のボトルネック」を特定するために、**Causal Forest** という機械学習モデルを活用します。

| # | 何をするか | Allyeのノード |
|---|---|---|
| 1 | 各工程のデータと歩留まりデータを読み込む | **File** |
| 2 | 各改善策が歩留まりに与える「真の効果」を個別に計算する<br/>• 介入 = `各工程の改善策` <br/>• 結果 = `歩留まり率` | **Causal Forest × 4** |
| 3 | 全改善策の効果をひと目で比較し、最も有望な打ち手を見つける | **Distributions, Box Plot** |

<p align="center">
  <img src="./imgs/semicon_workflow_overview.png"
       alt="semicon_workflow_overview" width="800">
</p>

*(一つ一つの分析（Causal Forest）は、他の工程や環境要因の影響を統計的に排除し、その施策だけの純粋な効果（因果効果）をあぶり出します)*

---

## 実践ウォークスルー：3ステップで発見する「金のなる木」

Allyeを使えば、複雑な分析もわずか数クリックで完了します。

### 1. データを接続する
まず、製造ラインから収集したデータ（各工程のパラメータ、原材料ロット、最終的な歩留まり率など）を含むCSVファイルを、**File**ウィジェットを使ってAllyeのキャンバスにドラッグ＆ドロップします。

<p align="center">
  <img src="./imgs/semicon_input_data.png" alt="semicon_input_data" width="600">
</p>

### 2. Causal Forestで因果効果を測定する
次に、比較したい改善策の数だけ **Causal Forest** ノードを配置します。今回は、「リソグラフィ」「エッチング」「CVD」「洗浄」の4工程の改善策を比較してみましょう。

各ノードで、以下のように設定します。
*   **Treatment (介入)**: その工程の改善策を適用したかどうかを示すカラム (例: `etching_condition_A`)
*   **Outcome (結果)**: `yield_rate` (歩留まり率)
*   **Covariates (共変量)**: 結果に影響を与えうる他のすべての要因（他の工程の主要パラメータ、気温、湿度、原材料ロット情報など）

<p align="center">
  <img src="./imgs/semicon_causal_forest_config.png" alt="semicon_causal_forest_config" width="450">
</p>
<small><i>Causal Forest — この設定だけで、Allyeは他の何十もの変数の影響を自動的に補正し、介入の「真の効果」だけを抽出します。</i></small>

### 3. 結果を比較し、ボトルネックを特定する
最後に、4つのCausal Forestからの出力を **Distributions** や **Box Plot** ウィジェットに接続し、「実行」ボタンをクリックします。

---

## 真実の瞬間：一枚のチャートが示す進むべき道

数分後、Allyeは分析を完了し、衝撃的なほどシンプルな答えを提示します。

```
工程改善策         平均歩留まり向上率     優先度
─────────────────────────────────────────────
エッチング (条件A)   +2.1% ± 0.2%       ★★★★☆
CVD (条件B)        +1.5% ± 0.3%       ★★★☆☆
リソグラフィ (条件C) +0.4% ± 0.5%       ★☆☆☆☆
洗浄 (条件D)         -0.2% ± 0.4%       ☆☆☆☆☆
```

この結果は明白です。**エッチング工程の条件A** こそが、現在のボトルネックを解消し、歩留まりを最も大きく向上させる施策です。これまで「怪しい」とされていたリソグラフィ工程の改善効果はごくわずかで、洗浄工程に至っては、むしろ歩留まりを下げてしまう可能性さえ示唆されています。

佐藤さんは、もう迷う必要はありません。データが、進むべき道をはっきりと照らし出してくれたのです。

---

## アクションプラン：データが導く最短のカイゼンルート

この明確な洞察に基づき、チームは迅速にアクションプランを策定しました。

*   **最優先タスク:** エッチング工程の「条件A」を全ラインに本格展開する。エンジニアリングリソースをここに集中投下。
*   **次点タスク:** CVD工程の「条件B」も効果が見込めるため、次回の改善サイクルで、より効果が高い特定の製品ロットに限定して試行する計画を立てる。
*   **保留タスク:** リソグラフィと洗浄工程の改善は見送る。これにより、無駄な工数とコストの発生を防ぐ。

---

## 勝利の分かち合い：1スプリントで歩留まり2%向上

結果はすぐに出ました。

1.  **アクション:** エッチング工程の改善策を展開。
2.  **結果:** わずか1週間で、工場全体の平均歩留まりが93.5%から**95.6%**へと向上。ついに目標を達成しました。
3.  **コスト:** これまで数ヶ月かかっていた原因究明と試行錯誤のサイクルが、わずか数日で完了。

佐藤さんと彼のチームは、勘や経験だけに頼るのではなく、データに基づいた因果関係を武器に、最短距離で成果を出すことに成功したのです。

---

### TL;DR

*   製造業の複雑なプロセス改善では、「相関」ではなく「因果」を見極めることが成功の鍵。
*   Causal Forestのような因果推論の手法は、数ある改善策の中から最も効果的な「真のボトルネック」を客観的に特定できる。
*   Allyeは、これらの高度な分析をノーコードで民主化し、あらゆるエンジニアが迅速かつ自信を持ってデータドリブンな意思決定を下すことを可能にする。

**もう、手探りの工程改善にリソースを浪費するのはやめましょう。Allyeで、あなたのデータに眠る「次の一手」を見つけ出しませんか？** 